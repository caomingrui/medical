(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4fdb510b"],{"5cd8":function(t,e,i){"use strict";i.r(e);var a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"journal"},[3==t.showState?i("div",{staticClass:"journal-shows"},[i("div",{staticClass:"journal-shows-nav"},[i("img",{attrs:{src:t.journalImg,alt:""}}),i("span",[t._v(t._s(t.journalName))])]),i("div",{staticClass:"journal-shows-cont"},t._l(t.articleIdList,(function(t,e){return i("div",{key:t},[i("articleListView",{attrs:{articleMess:t,articleInd:e}})],1)})),0)]):t._e(),3==t.showState?i("div",{staticClass:"advertis"},[t._m(0)]):t._e(),3!=t.showState?i("div",[0==t.showState?i("div",{staticClass:"defaultAll"},[i("el-breadcrumb",{staticStyle:{margin:"25px 0 30px 0"},attrs:{"separator-class":"el-icon-arrow-right"}},t._l(t.bread_crumbs,(function(e,a){return i("el-breadcrumb-item",{key:e.label,attrs:{to:{path:e.path}},nativeOn:{click:function(e){return t.test(a)}}},[t._v(t._s(e.label))])})),1),i("router-view")],1):t._e(),1==t.showState?i("div",{staticClass:"myJournal"},t._l(t.subscriptionList,(function(e){return i("div",{key:e.id,staticClass:"myJournal-list"},[i("div",{staticClass:"myJournal-list-img",on:{click:function(i){return t.openJournalList(e.nlmTitleAbbreviation,e.periodicalTitle,e.imgUrlMin,e.nlmId)}}},[i("img",{attrs:{src:e.imgUrlMin,alt:""}}),i("span",[t._v(t._s(e.periodicalTitle))])]),i("div",{staticClass:"myJournal-list-but",on:{click:function(i){return t.unsubscribe(e.id)}}},[t._v(" 取消订阅 ")])])})),0):t._e()]):t._e(),i("el-dialog",{attrs:{title:"提示",visible:t.dialogVisible,width:"30%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[i("span",[t._v("确定取消订阅吗？")]),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),i("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.canceleSubscription()}}},[t._v("确 定")])],1)])],1)},s=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("a",{attrs:{href:"../#/advertis",target:"_blank"}},[a("img",{attrs:{src:i("618d"),alt:""}})])}],r=(i("b0c0"),i("d3b7"),i("25f0"),i("d4ec")),o=i("bee2"),l=i("262e"),n=i("2caf"),c=i("9ab4"),u=i("60a3"),d=i("94bf"),h=i("0613"),g=i("98fc"),b=i.n(g),m=function(t){Object(l["a"])(i,t);var e=Object(n["a"])(i);function i(){var t;return Object(r["a"])(this,i),t=e.apply(this,arguments),t.showState=0,t.journalName="",t.bread_crumbs=h["a"].state.journalList,t.subscriptionList=[{}],t.articleIdList=[],t.journalImg="",t.rollerNum=0,t.page=0,t.finished=!0,t.currentPerId="",t.dialogVisible=!1,t}return Object(o["a"])(i,[{key:"created",value:function(){var t=this;this.bread_crumbs=h["a"].state.journalList,this.showState=this.$route.params.id,setInterval((function(){t.rollerNum++}),1e3),setTimeout((function(){t.listenerFunction()}),8e3)}},{key:"mounted",value:function(){this.pageSubscribe(),"3"==this.$route.params.id&&h["a"].state.periodicalArticlesList&&(this.journalName=h["a"].state.periodicalArticlesList.name,this.journalImg=h["a"].state.periodicalArticlesList.img,this.pageJournalArticleList(h["a"].state.periodicalArticlesList.keyword),this.page=0,this.finished=!0)}},{key:"test",value:function(t){h["a"].commit("changeJournal",t)}},{key:"pageSubscribe",value:function(){var t=this;this.$request.get("/main/h5/periodical/findPeriodical").then((function(e){"00000000"==e.code?(console.log("---------- 查询订阅成功啦 ----------"),t.subscriptionList=e.data):(console.log("---------- 查询订阅失败啦 ----------"),t.$message.error(e.message))}))}},{key:"openJournalList",value:function(t,e,i,a){var s={name:e,keyword:t,img:i,id:a};localStorage.setItem("periodicalArticlesList",JSON.stringify(s)),h["a"].commit("savePeriodicalArticlesList",s),this.$router.push({name:"all",params:{id:"3"}}),this.journalName=e,this.journalImg=i,this.pageJournalArticleList(t)}},{key:"pageJournalArticleList",value:function(t){var e=this;this.finished=!0,this.$axios.get("https://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=pubmed&RetStart="+10*this.page+"&RetMax=10&term="+t+'&sort="Recently Added"').then((function(t){var i=t.data,a=new b.a,s=a.xml2js(i);console.log("json --------------------"),console.log(s),console.log("json --------------------"),console.log(s.eSearchResult.IdList.Id);var r=s.eSearchResult.IdList.Id,o=0,l=setInterval((function(){"[object Undefined]"!=Object.prototype.toString.call(r)&&(e.articleIdList.push(r[o]),o++,o>r.length-1&&clearInterval(l))}),1e3);e.pageCollectNum(r)}))}},{key:"canceleSubscription",value:function(){var t=this,e=this,i=e.currentPerId;this.$request.get("/main/h5/periodical/unsubscribe?id="+i).then((function(i){"00000000"==i.code?(console.log("-------- 取消期刊订阅ok ------------"),e.pageSubscribe(),e.$message("取消成功"),e.dialogVisible=!1):(console.log("-------- 取消期刊订阅不ok ------------"),t.$message.error(i.message))}))}},{key:"unsubscribe",value:function(t){this.currentPerId=t,this.dialogVisible=!0}},{key:"pageCollectNum",value:function(t){var e=this;this.$request.get("/main/h5/article/findFollowCount?ids="+t).then((function(t){console.log(t),"00000000"==t.code?(console.log("-------- 收藏数量查询ok -----------"),h["a"].commit("saveCollectNumberList",t.data),localStorage.setItem("saveCollectNumberList",JSON.stringify(t.data))):(console.log("-------- 收藏数量查询no -----------"),e.$message.error(t.message))}))}},{key:"listenerFunction",value:function(){var t=document.querySelector(".journal-shows-cont");t.addEventListener("scroll",this.handleScroll,!0)}},{key:"handleScroll",value:function(){var t=document.querySelector(".journal-shows-cont");if(console.log("期刊详情"),t.scrollHeight-t.scrollTop<=701&&this.finished)if(this.rollerNum<8)this.$message({message:"加载完才能下拉刷新哦",type:"warning"});else{this.page=this.page+1,this.finished=!1;var e=h["a"].state.periodicalArticlesList.keyword;this.pageJournalArticleList(e),console.log("我到底了嘛！")}}},{key:"get$route",value:function(t,e){console.log(t.params.id),this.showState=t.params.id,console.log(h["a"].state.currentJournals),this.pageSubscribe();var i=Object.prototype.toString.call(h["a"].state.currentJournals);"[object Object]"==i&&(this.pageJournalArticleList(h["a"].state.currentJournals.nlmTitleAbbreviation),this.journalName=h["a"].state.currentJournals.periodicalTitle,this.journalImg=h["a"].state.currentJournals.imgUrlMin)}},{key:"getBread_crumbs",value:function(t,e){this.bread_crumbs=t}}]),i}(u["c"]);Object(c["a"])([Object(u["d"])("$route")],m.prototype,"get$route",null),Object(c["a"])([Object(u["d"])("bread_crumbs")],m.prototype,"getBread_crumbs",null),m=Object(c["a"])([Object(u["a"])({components:{articleListView:d["a"]}})],m);var p=m,v=p,f=(i("a81c"),i("2877")),j=Object(f["a"])(v,a,s,!1,null,"2ab683ca",null);e["default"]=j.exports},"618d":function(t,e,i){t.exports=i.p+"img/advertis.b55b32f0.jpg"},a81c:function(t,e,i){"use strict";var a=i("ed7c"),s=i.n(a);s.a},ed7c:function(t,e,i){}}]);
